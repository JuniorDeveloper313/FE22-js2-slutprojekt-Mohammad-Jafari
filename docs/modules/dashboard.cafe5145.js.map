{"mappings":"AAcA,MAAMA,EAAYC,SAASC,cAAc,uBACnCC,EAAUF,SAASC,cAAc,sBACjCE,EAAOC,aAAaC,QAAQ,aAC5BC,EAAmBH,EAAOI,KAAKC,MAAML,GAAQ,KAC7CM,EAAOL,aAAaC,QAAQ,OAC5BK,EAAaD,EAAOF,KAAKC,MAAMC,GAAQ,KACvCE,EAAiBX,SAASC,cAAc,UACxCW,EAAgBZ,SAASC,cAAc,SACvCY,EAAmBb,SAASC,cAAc,aAChD,IAAIa,EACJ,MAAMC,EAAYf,SAASC,cAAc,kBAmBzCe,eAAeC,IACXN,EAAeO,UAAY,GAE3B,MAAMC,QAAYC,MAAM,wFAClBC,QAAaF,EAAIG,OAEQC,OAAOC,OAAOH,GAEjBI,MAAK,CAACC,EAAGC,KACjC,MAAMC,EAAQ,IAAIC,KAAKF,EAAEG,WACnBC,EAAQ,IAAIF,KAAKH,EAAEI,WACzB,OAAOF,EAAMI,UAAYD,EAAMC,SAAO,IAGlCC,KAAKC,IACT,MAAMC,EAAWzB,EAAW0B,OAAOF,EAAIG,MAEvC,IAAIC,EAAK,yGAGKJ,EAAIK,wCACEJ,8GAITD,EAAIA,8DAKfvB,EAAeO,WAAaoB,CAAA,GAEpC,CAhDAvC,GAAWyC,iBAAiB,SAAS,KACjC,IAAIN,EAAM,CACNA,IAAKhC,EAAQuC,MACbF,KAAMjC,EAAWiC,KACjBF,IAAK/B,EAAW+B,IAChBP,WAAW,IAAID,MAAOa,eAG1BtB,MAAM,uFAAwF,CAC1FuB,OAAQ,OACRC,KAAMrC,KAAKsC,UAAUX,KACtBY,MAAK,KACJ7B,GAAA,GACJ,IAkFJF,EAAUyB,iBAAiB,SAAS,KAChC,IAAIO,EAAkBxB,OAAOC,OAAOV,GAEpCS,OAAOC,OAAOuB,GAASd,KAAI,CAACe,EAAMC,KAZtC,IAAyBC,EAabF,EAAKT,OAASjC,EAAWiC,OAbZW,EAcG3B,OAAO4B,KAAKrC,GAAamC,GAbjD7B,MAAM,mFAAmF8B,SAAW,CAAEP,OAAQ,WACzGG,MAAK,KACH1C,aAAagD,WAAW,aACxBC,OAAOC,SAASC,OAAO,oBAUqB,GAEnD,IAxCJvC,iBACI,MAAMG,QAAYC,MAAM,wFAClBC,QAAaF,EAAIG,OAEvBR,EAAcO,EACd,IAAI0B,EAAkBxB,OAAOC,OAAOH,GAEpCE,OAAOC,OAAOuB,GAASd,KAAI,CAACe,EAAMC,KAC9B,MAAMd,EAAWzB,EAAW0B,OAAOY,EAAKX,MAExC,IAAIC,EAAK,yHAE4Bf,OAAO4B,KAAK9B,GAAM4B,WAAWD,EAAKT,gCACzDS,EAAKT,wCACCJ,yGAKpBtB,EAAiBK,WAAaoB,CAAA,GAEtC,CAuBAkB,GAxDA,WACI,MAAMrB,EAAWzB,EAAW0B,OAAO9B,EAAW+B,MAE9C,IAAIW,EAAO,aACL1C,EAAWiC,4CACWJ,gEAI5BvB,EAAcM,WAAa8B,CAC/B,CA+CAS,GACAxC","sources":["src/modules/dashboard.ts"],"sourcesContent":["type User = {\r\n    id: Number,\r\n    name: String,\r\n    password: String,\r\n    img: Number,\r\n}\r\n\r\ntype msgType = {\r\n    msg: String,\r\n    name: String,\r\n    img: Number,\r\n    createdAt: Date,\r\n}\r\n\r\nconst submitBtn = document.querySelector('.create-post button');\r\nconst message = document.querySelector('.create-post input') as HTMLInputElement;\r\nconst user = localStorage.getItem('myProfile')\r\nconst parsedUser: User = user ? JSON.parse(user) : null;\r\nconst imgs = localStorage.getItem('img');\r\nconst parsedImgs = imgs ? JSON.parse(imgs) : null;\r\nconst postsContainer = document.querySelector('.posts') as HTMLElement;\r\nconst userContainer = document.querySelector('.user') as HTMLElement;\r\nconst allUserContainer = document.querySelector('.all-user') as HTMLElement;\r\nlet allDataUser;\r\nconst deleteBtn = document.querySelector('.delete button') as HTMLElement;\r\n\r\n\r\nsubmitBtn?.addEventListener('click', () => {\r\n    let msg = {\r\n        msg: message.value,\r\n        name: parsedUser.name,\r\n        img: parsedUser.img,\r\n        createdAt: new Date().toISOString() // det här används sedan för att sortera det senaste meddelandet\r\n    }\r\n\r\n    fetch('https://social-media-bebf1-default-rtdb.europe-west1.firebasedatabase.app/posts.json', {  // skicka en POST-förfrågan för att lägga till meddelande i Firebase\r\n        method: \"POST\",\r\n        body: JSON.stringify(msg),\r\n    }).then(() => {\r\n        displayMsg()\r\n    });\r\n})\r\n\r\nasync function displayMsg() {// Hämta en lista med alla meddelanden som finns i Firebase.\r\n    postsContainer.innerHTML = \"\";\r\n\r\n    const res = await fetch('https://social-media-bebf1-default-rtdb.europe-west1.firebasedatabase.app/posts.json');\r\n    const data = await res.json();\r\n\r\n    let convertedData: msgType[] = Object.values(data);\r\n\r\n    let newData = convertedData.sort((a, b) => {\r\n        const bDate = new Date(b.createdAt);\r\n        const aDate = new Date(a.createdAt);\r\n        return bDate.getTime() - aDate.getTime();\r\n    });\r\n\r\n    newData.map((msg) => {\r\n        const checkImg = parsedImgs[Number(msg.img)];\r\n\r\n        let el = `\r\n                <div class=\"post\">\r\n                <div class=\"user-profile\">\r\n                <h6>${msg.name}</h6>\r\n                <img src=\"${checkImg}\" style=\"width: 50px\"\r\n                    alt=\"\">\r\n            </div>\r\n            <p>\r\n                 ${msg.msg}\r\n            </p>\r\n                </div>\r\n            `;\r\n\r\n        postsContainer.innerHTML += el;\r\n    })\r\n}\r\n\r\nfunction showMyUser() { // Få en lista över min kontoinformation\r\n    const checkImg = parsedImgs[Number(parsedUser.img)];\r\n\r\n    let user = `\r\n    <h3>${parsedUser.name}</h3>\r\n                    <img src=\"${checkImg}\" style=\"width: 40px\"\r\n                        alt=\"\">\r\n    `;\r\n\r\n    userContainer.innerHTML += user;\r\n}\r\n\r\nasync function allUsers() { // Lista ut all användaren som finns i databasen\r\n    const res = await fetch('https://social-media-bebf1-default-rtdb.europe-west1.firebasedatabase.app/users.json');\r\n    const data = await res.json();\r\n\r\n    allDataUser = data\r\n    let newData: User[] = Object.values(data);\r\n\r\n    Object.values(newData).map((user, i) => {\r\n        const checkImg = parsedImgs[Number(user.img)];\r\n\r\n        let el = `\r\n            <div class=\"user\" style=\"border: 1px solid; padding: 1rem\">\r\n                <a href=\"./profile.html?id=${Object.keys(data)[i]}&name=${user.name}\" >\r\n                <h6>${user.name}</h6>\r\n                <img src=\"${checkImg}\" style=\"width:50px\"\r\n                    alt=\"\">\r\n                </a>\r\n            </div>\r\n        `\r\n        allUserContainer.innerHTML += el\r\n    })\r\n}\r\n\r\n\r\nfunction deleteMyAccount(id) { // ta bort min användare\r\n    fetch(`https://social-media-bebf1-default-rtdb.europe-west1.firebasedatabase.app/users/${id}.json`, { method: 'DELETE' })\r\n        .then(() => {\r\n           localStorage.removeItem('myProfile'); \r\n           window.location.assign('../index.html'); \r\n        })\r\n}\r\n\r\n\r\ndeleteBtn.addEventListener('click', () => {  \r\n    let newData: User[] = Object.values(allDataUser);\r\n\r\n    Object.values(newData).map((user, i) => { // Hämta användaren från databasen och jämför användarens namn med vårt kontos användarnamn\r\n        if (user.name === parsedUser.name) {\r\n            deleteMyAccount(Object.keys(allDataUser)[i]); // Baserat på matchat index extraherar vi ID som är kopplat till objectet för att sedan ta bort den användaren. \r\n        }\r\n    })\r\n})\r\n\r\n\r\nallUsers()\r\nshowMyUser()\r\ndisplayMsg()"],"names":["$7f111d3a49f727d1$var$submitBtn","document","querySelector","$7f111d3a49f727d1$var$message","$7f111d3a49f727d1$var$user","localStorage","getItem","$7f111d3a49f727d1$var$parsedUser","JSON","parse","$7f111d3a49f727d1$var$imgs","$7f111d3a49f727d1$var$parsedImgs","$7f111d3a49f727d1$var$postsContainer","$7f111d3a49f727d1$var$userContainer","$7f111d3a49f727d1$var$allUserContainer","$7f111d3a49f727d1$var$allDataUser","$7f111d3a49f727d1$var$deleteBtn","async","$7f111d3a49f727d1$var$displayMsg","innerHTML","res","fetch","data","json","Object","values","sort","a","b","bDate","Date","createdAt","aDate","getTime","map","msg","checkImg","Number","img","el","name","addEventListener","value","toISOString","method","body","stringify","then","newData","user","i","id","keys","removeItem","window","location","assign","$7f111d3a49f727d1$var$allUsers","$7f111d3a49f727d1$var$showMyUser"],"version":3,"file":"dashboard.cafe5145.js.map"}